---
title: P4017题解
date: 2023-01-16 09:41:37
tags:
- 拓扑排序
- 图论
categories: 题解
url: solution-P4017
---

# 最大食物链计数

## 题目背景

你知道食物链吗？Delia 生物考试的时候，数食物链条数的题目全都错了，因为她总是重复数了几条或漏掉了几条。于是她来就来求助你，然而你也不会啊！写一个程序来帮帮她吧。

## 题目描述

给你一个食物网，你要求出这个食物网中最大食物链的数量。

（这里的“最大食物链”，指的是**生物学意义上的食物链**，即**最左端是不会捕食其他生物的生产者，最右端是不会被其他生物捕食的消费者**。）

Delia 非常急，所以你只有 $1$ 秒的时间。

由于这个结果可能过大，你只需要输出总数模上 $80112002$ 的结果。

## 输入格式

第一行，两个正整数 $n、m$，表示生物种类 $n$ 和吃与被吃的关系数 $m$。

接下来 $m$ 行，每行两个正整数，表示被吃的生物A和吃A的生物B。

## 输出格式

一行一个整数，为最大食物链数量模上 $80112002$ 的结果。

## 样例 #1

### 样例输入 #1

```in
5 7
1 2
1 3
2 3
3 5
2 5
4 5
3 4
```

### 样例输出 #1

```out
5
```

## 提示

各测试点满足以下约定：

 ![](https://photo-1314795557.cos.ap-beijing.myqcloud.com/12011.png) 

【补充说明】

数据中不会出现环，满足生物学的要求。（感谢 @AKEE ）

---

# 题解

这道题就是拓补排序的板子题。

举个栗子：

![image-20230116100817856](https://photo-1314795557.cos.ap-beijing.myqcloud.com/image-20230116100817856.png)

最大食物链的要求就是从入度为$0$的点走到出度为$0$的点，在寻找拓补序列的过程中，我们只需要记录一下到当前点的食物链长度即可。

代码如下：

```cpp
#include<bits/stdc++.h>
using namespace std;
int n,m,ru[5005],chu[5005],a,b,f[5005],ans;
int gg[5005][5005];
queue<int> q;
int main()
{
	cin>>n>>m;
	for(int i=1;i<=m;i++)
	{
		cin>>a>>b;
		gg[a][b]=1;
		chu[a]++;
		ru[b]++;
	}
	for(int i=1;i<=n;i++)
	{
		if(ru[i]==0) 
			f[i]=1,q.push(i);
	}
	while(!q.empty())
	{
		int a=q.front();
		q.pop();
		for(int k=1;k<=n;k++)
		{
			if(gg[a][k]==0) continue;
			f[k]+=f[a];
			f[k]%=80112002;
			ru[k]--;
			if(ru[k]==0)
			{
				if(chu[k]==0)
					ans+=f[k],ans%=80112002;
				q.push(k);
			}
		}
	}
	cout<<ans; 
}
```

